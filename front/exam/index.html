<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

	<!-- í°íŠ¸ì–´ì¸ -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

	<style>
    h1 {
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px 0;     
    }

    #form {
    display: flex;
    gap: 10px;
    }
    #input {
      flex: 1;
      resize: vertical;
    }
    .btns{
			display: flex;
      align-items: center;
      justify-content: center;
      align-items: stretch;
		}
    .btn-del {
    color: gray;
    background-color: transparent; /* ë°°ê²½ìƒ‰ ì—†ì• ê¸° */
    }
		.list{
			list-style: none; padding: 0;
		}
		.list li{
			display: flex;
			margin-bottom: 20px;
			justify-content: space-between;
		}   
	</style>
  <script src="index.js"></script>
</head>
<body>
	<header>
		<h1 class="text-center">ë©”ëª¨íŒ¨ë“œğŸ“</h1>
	</header>
	<main class="container">
		<form id="form" class="mb-3">
    <textarea id="input" class="form-control" rows="6" placeholder="ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
    <button type="submit" class="btn btn-primary">ì¶”ê°€</button>
</form>
		<ul class="list">
		</ul>
	</main>
	<script>
    		/* ë©”ëª¨ë¥¼ ë“±ë¡í•˜ê³ , ì‚­ì œë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‚­ì œë˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„ */
		const btn = document.querySelector("button");
		const input = document.querySelector("#input");
		const form = document.querySelector("#form");
		const list = document.querySelector(".list");
		const TITLE = "list1";

		form.onsubmit = (e) => e.preventDefault();
		form.addEventListener("submit", (e) =>e.preventDefault());

		btn.addEventListener("click", addItem);

		document.addEventListener("DOMContentLoaded", ()=> {
			loadLS();
			drawEmpty()
		})
    
		//ì¶”ê°€
		function addItem(e){
			//ì…ë ¥ëœ ê°’ì„ ê°€ì ¸ì˜´ => inputìš”ì†Œì˜ valueê°’ì„ ê°€ì ¸ì˜´(í‘œì¤€ ì†ì„±)
			let text = input.value;

			if(list.querySelectorAll("li .title").length == 0){
				list.innerHTML = '';
			}

			let li = createItem(text);
			list.append(li);

			setLiDataSet(li, text);
			input.value = "";
			saveLS();
		}
	
		//ì‚­ì œ
		list.addEventListener("click", function(e){
			let el = e.target;
			if(el.classList.contains("btn-del")){
				el.closest("li").remove();
			}
			saveLS();
			drawEmpty()
		});


		function createItem(text){
			//li íƒœê·¸ë¡œ ëœ ìš”ì†Œë¥¼ ìƒì„±. ìš”ì†Œ.createElement(íƒœê·¸ëª…)
			let li = document.createElement("li");


			//spaníƒœê·¸ë¥¼ ìƒì„±
      //spanì— textì¶”ê°€
			let span = document.createElement("span");
			span.textContent = text;
			span.classList.add("title")
      span.style.whiteSpace = "pre-wrap";
			li.append(span);
	
			let btns = document.createElement("div");

			let delBtn = document.createElement("button");
      delBtn.textContent = "ì‚­ì œ";
			delBtn.classList.add("btn-del", "btn", "btn-sm");
			
			btns.append(delBtn);
			btns.classList.add("btns");

			li.append(btns);
			return li;
		}

		function loadLS(){
			let objs = JSON.parse(localStorage.getItem(TITLE));
			if(!objs){
				return;
			}
			objs.forEach(obj =>{
				let li = createItem(obj.content);
				list.append(li);
			})
		}

		function saveLS(){
			//ul ë¦¬ìŠ¤íŠ¸ ë°‘ì— ìˆëŠ” ëª¨ë“  li
			let items = list.querySelectorAll("li");

			let itemList = [];
		
			items.forEach(item=>{
				
				//ê°ì²´ë¡œ ë§Œë“¤ì–´ì„œ ë°°ì—´ì— ì €ì¥
				let obj = getLiDataSet(item);
				if(obj){
					itemList.push(obj);
				}
			})
			
			localStorage.setItem(TITLE, JSON.stringify(itemList));
		}

		function setLiDataSet(li, content){
			let target = li.querySelector(".title");
			target.dataset.content = content;
		}
		function getLiDataSet(li){
			let target = li.querySelector(".title");
			console.log(target)
			if(!target){
				return;
			}
			return memo(target.dataset.content)
		}

	</script>
</body>
</html>